<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestión de Empresas y Sucursales</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>

  <!-- Hoja de estilos global minimalista -->
  <link rel="stylesheet" href="../../css/empresaglobal.css" />

  <!-- Lógica de la página -->
  <script defer src="empresas.js"></script>
</head>
<body>
  <h1 class="mb-4">Gestión de Empresas y Sucursales</h1>

  <div class="buttons d-flex gap-2 mb-4">
    <button class="btn btn-primary" onclick="showEmpresas()">Empresas</button>
    <button class="btn btn-primary" onclick="showSucursales()">Sucursales</button>
    <button class="btn btn-outline-danger ms-auto" onclick="window.location.href='../../index.html'">
      Volver a Principal
    </button>
  </div>

  <!-- Contenedor de Empresas -->
  <div id="empresasContainer" class="container-fluid p-0" style="display:none;">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h2 class="h5 mb-0">Empresas</h2>
      <button class="btn btn-primary" onclick="openModal('addEmpresaModal')">Agregar Empresa</button>
    </div>
    <table id="empresasTable" class="table table-hover">
      <thead class="table-dark">
        <tr>
          <th>Nombre</th>
          <th>Dirección</th>
          <th>Teléfono</th>
          <th>Correo Electrónico</th>
          <th>Fecha de Creación</th>
          <th>Descripción</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Contenedor de Sucursales -->
  <div id="sucursalesContainer" class="container-fluid p-0" style="display:none;">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h2 class="h5 mb-0">Sucursales</h2>
      <div class="d-flex gap-2">
        <select id="empresaFilterSelect" class="form-select" style="max-width:240px;" onchange="loadSucursales()">
          <option value="">Todas las empresas</option>
        </select>
        <button class="btn btn-primary" onclick="openAddSucursalModal()">Agregar Sucursal</button>
      </div>
    </div>
    <table id="sucursalesTable" class="table table-hover">
      <thead class="table-dark">
        <tr>
          <th>Nombre</th>
          <th>Dirección</th>
          <th>Teléfono</th>
          <th>Correo Electrónico</th>
          <th>Fecha de Creación</th>
          <th>Encargado</th>
          <th>Descripción</th>
          <th>Estado</th>
          <th>Empresa</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- ===== Modales (misma estructura, sin estilos embebidos) ===== -->

  <!-- Modal: Agregar Empresa -->
  <div id="addEmpresaModal" class="modal">
    <div class="modal-content">
      <span class="close btn-close" onclick="closeModal('addEmpresaModal')"></span>
      <h2 class="h5 mb-3">Agregar Empresa</h2>

      <input type="text" id="empresaName" class="form-control mb-2" placeholder="Nombre de la Empresa" />
      <input type="text" id="empresaAddress" class="form-control mb-2" placeholder="Dirección" />
      <input type="tel" id="empresaPhone" class="form-control mb-2" placeholder="Teléfono" />
      <input type="email" id="empresaEmail" class="form-control mb-2" placeholder="Correo Electrónico" />
      <input type="date" id="empresaCreationDate" class="form-control mb-2" />
      <input type="text" id="empresaDescription" class="form-control mb-2" placeholder="Descripción" />
      <select id="empresaStatus" class="form-select mb-3">
        <option value="activo">Activo</option>
        <option value="inactivo">Inactivo</option>
      </select>

      <button class="btn btn-primary w-100" onclick="addEmpresa()">Agregar Empresa</button>
    </div>
  </div>

  <!-- Modal: Editar Empresa -->
  <div id="editEmpresaModal" class="modal">
    <div class="modal-content">
      <span class="close btn-close" onclick="closeModal('editEmpresaModal')"></span>
      <h2 class="h5 mb-3">Editar Empresa</h2>

      <input type="hidden" id="editEmpresaId" />
      <input type="text" id="editEmpresaName" class="form-control mb-2" placeholder="Nombre de la Empresa" />
      <input type="text" id="editEmpresaAddress" class="form-control mb-2" placeholder="Dirección" />
      <input type="tel" id="editEmpresaPhone" class="form-control mb-2" placeholder="Teléfono" />
      <input type="email" id="editEmpresaEmail" class="form-control mb-2" placeholder="Correo Electrónico" />
      <input type="date" id="editEmpresaCreationDate" class="form-control mb-2" />
      <input type="text" id="editEmpresaDescription" class="form-control mb-2" placeholder="Descripción" />
      <select id="editEmpresaStatus" class="form-select mb-3">
        <option value="activo">Activo</option>
        <option value="inactivo">Inactivo</option>
      </select>

      <button class="btn btn-primary w-100" onclick="updateEmpresa()">Guardar Cambios</button>
    </div>
  </div>

  <!-- Modal: Agregar Sucursal -->
  <div id="addSucursalModal" class="modal">
    <div class="modal-content">
      <span class="close btn-close" onclick="closeModal('addSucursalModal')"></span>
      <h2 class="h5 mb-3">Agregar Sucursal</h2>

      <input type="text" id="sucursalName" class="form-control mb-2" placeholder="Nombre de la Sucursal" />
      <input type="text" id="sucursalAddress" class="form-control mb-2" placeholder="Dirección" />
      <input type="tel" id="sucursalPhone" class="form-control mb-2" placeholder="Teléfono" />
      <input type="email" id="sucursalEmail" class="form-control mb-2" placeholder="Correo Electrónico" />
      <input type="date" id="sucursalCreationDate" class="form-control mb-2" />
      <input type="text" id="sucursalEncargado" class="form-control mb-2" placeholder="Encargado" />
      <input type="text" id="sucursalDescription" class="form-control mb-2" placeholder="Descripción" />
      <select id="sucursalStatus" class="form-select mb-2">
        <option value="activo">Activo</option>
        <option value="inactivo">Inactivo</option>
      </select>
      <select id="empresaSelect" class="form-select mb-3"></select>

      <button class="btn btn-primary w-100" onclick="addSucursal()">Agregar Sucursal</button>
    </div>
  </div>

  <!-- Modal: Editar Sucursal -->
  <div id="editSucursalModal" class="modal">
    <div class="modal-content">
      <span class="close btn-close" onclick="closeModal('editSucursalModal')"></span>
      <h2 class="h5 mb-3">Editar Sucursal</h2>

      <input type="hidden" id="editSucursalId" />
      <input type="text" id="editSucursalName" class="form-control mb-2" placeholder="Nombre de la Sucursal" />
      <input type="text" id="editSucursalAddress" class="form-control mb-2" placeholder="Dirección" />
      <input type="tel" id="editSucursalPhone" class="form-control mb-2" placeholder="Teléfono" />
      <input type="email" id="editSucursalEmail" class="form-control mb-2" placeholder="Correo Electrónico" />
      <input type="date" id="editSucursalCreationDate" class="form-control mb-2" />
      <input type="text" id="editSucursalEncargado" class="form-control mb-2" placeholder="Encargado" />
      <input type="text" id="editSucursalDescription" class="form-control mb-2" placeholder="Descripción" />
      <select id="editSucursalStatus" class="form-select mb-2">
        <option value="activo">Activo</option>
        <option value="inactivo">Inactivo</option>
      </select>
      <select id="editEmpresaSelect" class="form-select mb-3"></select>

      <button class="btn btn-primary w-100" onclick="updateSucursal()">Guardar Cambios</button>
    </div>
  </div>
</body>
</html>
